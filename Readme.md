# Balance Service

Это мое первое знакомство с языком Go.
И первый проект, который по немногу затрагивает все, что мной изучалось до этого (MySql, Docker, HTTP).
Было интерносно разбираться в новом языке, настраивать взаимодействие между БД и сервером, создовать контейнер для равертывания собственного приложения.
По итогу узнал много чего интересного. Осознал, что способен создавать микросервисы, что смогу взять на себя Backend во время хакатонов.  
А теперь детали проекта.  
Сервис позволяет хранить и управлять балансом пользователей.

### Как запустить?

Это только пример запуска.

> git clone https://github.com/Kot2Na/Go_server.git  
> docker build -t service:go_server ./Go_server  
> docker run -p 8080:8080 --name balance_service -it service:go_server  

База данных развертывается внутри контейнера ubuntu.

### Как с этим работать?

В корне проекта есть файл **Tests.txt**, хранящий мои личные тесты (использую curl для отправления запросов).


## Протокол взамодействия

Данные передаются по HTTP, в качестве тела запроса используется JSON структура со следующими полями.  
Не обязательно заполнять всю структуру, можно только её часть.
Каждый обработчик берет только нужную для реализации запроса информацию. (поясню дальше)


#### RequestStruct
```JSON
{
  "method":"method_name",
  "data":{
    "replenishment":{
      "id":5,
      "value":5.24
    },
    "withdrawal":{
      "id":6,
      "value":7.78
    },
    "transfer":{
      "id_from":5,
      "id_to":7,
      "value":3.22
    },
    "user":{
      "id":21,
      "first_name":"string",
      "last_name":"string"
    },
    "currency":"currency_code",
    "sort":"sort_flag"
  }
}
```

В качестве исходящего запроса используется JSON стуктура со следующими полями.
Каждый обработчик отправляет только нужную информацию, будет описано в методах. 

#### ResponseStruct
```JSON
{
  "Message":"Comment to method",
  "Method":"method_name",
  "Data":{  
    "user_id":5,
    "transaction_id":6,
    "currency":"USD",
    "value":332.5,
    "userstransactions":[{
        "info":"string",
        "value":"float_num",
        "date":"string_date"
      }]
  }
}
```


## Реализованные методы

### Методы POST
- **/AddUser**  
  - Метод смотрит на структуру **user**, создает пользователя с указанной информацией.
  - Метод возвращает **user_id** созданного пользователя
  
- **/Replenishment**
  - Метод смотрит на структуру **replenishment**, увеливает баланс пользователя на указанное значение.
  - Метод возвращает **transaction_id** только что созданной транзакции.
  
- **/Withdrawal**
  - Метод смотрит на структуру **withdrawal**, уменьшает баланс пользователя на указанное значение.
  - Метод возвращает **transaction_id** только что созданной транзакции.

- **/Transfer**
  - Метод смотрит на структуру **transfer**, уменьшет баланс **id_from** и увеличивает баланс  **id_to** на указаное значание.
  - Метод возвращает **transaction_id** только что созданной транзакции.
  
### Методы GET
- **/Balance**  
  - Метод смотрит на структуру **user** и на значение поля **currency (трехбуквенный код валюты)**.
  - Метод возвращает баланс пользователя **id** в указанной валюте (рубли по умолчанию).

- **/Transactions**  
  - Метод смотрит на структуру **user** и на значение поля **sort ("time" or "value")**.
  - Метод возвращает список транзакций пользователя **id** с учётом сортировки (абсолютное значение по умолчанию).












